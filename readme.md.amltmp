# Reservoir Engineer Latent User Modeling (Neal/MATS-Style Mechanistic Interpretability Project)

This project investigates whether a language model implicitly represents **domain-specific user personas** â€” specifically **Reservoir Engineers (RE)** â€” and whether those latent directions are **causally manipulable**.

It follows the core structure of mechanistic interpretability research used in the **Neel Nanda MATS program**:
1. Build a synthetic dataset that varies a latent trait.
2. Extract hidden states layer-by-layer.
3. Identify latent directions through PCA or linear methods.
4. Perform *causal interventions* by ablating or amplifying the direction.
5. Measure downstream behavioural effects.
6. Document findings rigorously with plots and code.

---

## ğŸš§ Problem Definition

When interacting with technical users (like Reservoir Engineers), LLMs respond in a way that suggests they infer:
- domain expertise  
- preferred terminology  
- safety constraints  
- level of detail required  

But:
> **Where in the network is this â€œuser personaâ€ encoded, and can we causally manipulate it?**

This project investigates that question using a small synthetic dataset and a publicly available transformer model.

---

## ğŸ¯ Research Goal (As aligned with Neel Nanda)

1. **Latent Trait Identification**  
   Create prompts that systematically vary "Reservoir Engineer vs Non-Engineer" framing.

2. **Representation Probing**  
   Extract hidden activations from each transformer layer.

3. **Latent Direction Discovery**  
   Use PCA to identify the dominant direction separating RE-framed prompts.

4. **Causal Testing (Ablation)**  
   Remove that direction from hidden states and measure:
   - drop in embedding norm  
   - shift in model responses  
   - loss of RE-specific structure

5. **Plot + Report**  
   Provide clean plots that clearly show:
   - mean activation shift  
   - ablation effect magnitude  

This delivers exactly the type of analysis MATS expects:  
**find a feature â†’ interpret it â†’ causally test it.**

---

## ğŸ“ Repository Structure

